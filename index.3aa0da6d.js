!function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function n(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(t,n)}}function r(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||n(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var a=new/*#__PURE__*/(function(){var e,a;function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.defaultState();!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),this.score=0,this.status="idle",this.initialState=this.cloneState(t),this.state=this.cloneState(t),this.size=t.length}return e=[{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){"idle"===this.status&&(this.status="playing",this.addRandomTile(),this.addRandomTile())}},{key:"restart",value:function(){this.state=this.cloneState(this.initialState),this.score=0,this.status="idle"}},{key:"addRandomTile",value:function(){var t=this.getEmptyTiles();if(t.length>0){var e,r=Math.floor(Math.random()*t.length),a=function(t){if(Array.isArray(t))return t}(e=t[r])||function(t,e){var n,r,a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var i=[],o=!0,s=!1;try{for(a=a.call(t);!(o=(n=a.next()).done)&&(i.push(n.value),2!==i.length);o=!0);}catch(t){s=!0,r=t}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return i}}(e,2)||n(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=a[0],o=a[1];this.state[i][o]=.9>Math.random()?2:4}}},{key:"move",value:function(t){"playing"===this.status&&this.performMove(t)&&(this.addRandomTile(),this.checkGameState())}},{key:"moveRight",value:function(){this.move("right")}},{key:"moveLeft",value:function(){this.move("left")}},{key:"moveUp",value:function(){this.move("up")}},{key:"moveDown",value:function(){this.move("down")}},{key:"hasEmptyCells",value:function(){return this.getEmptyTiles().length>0}},{key:"canCombine",value:function(){for(var t=0;t<this.size;t++)for(var e=0;e<this.size;e++){var n=this.state[t][e];if(e<this.size-1&&n===this.state[t][e+1]||t<this.size-1&&n===this.state[t+1][e])return!0}return!1}},{key:"checkGameState",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,a=this.state[Symbol.iterator]();!(t=(r=a.next()).done);t=!0)if(r.value.includes(2048)){this.status="win";return}}catch(t){e=!0,n=t}finally{try{t||null==a.return||a.return()}finally{if(e)throw n}}this.hasEmptyCells()||this.canCombine()||(this.status="lose")}},{key:"performMove",value:function(t){var e=this.cloneState(this.state),n=[],a="up"===t||"down"===t,i="right"===t||"down"===t,o=a?this.transposeState(this.state):this.state,s=!0,u=!1,l=void 0;try{for(var c,f=o[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var h=c.value,v=i?r(h).reverse():h,y=this.combineRow(v),m=this.padRow(y),d=i?m.reverse():m;n.push(d)}}catch(t){u=!0,l=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw l}}return this.state=a?this.transposeState(n):n,!this.areStatesEqual(e,this.state)}},{key:"combineRow",value:function(t){for(var e=[],n=t.filter(function(t){return 0!==t}),r=0;r<n.length;r++)if(n[r]===n[r+1]){var a=2*n[r];e.push(a),this.score+=a,r++}else e.push(n[r]);return e}},{key:"padRow",value:function(t){return r(t).concat(r(Array(this.size-t.length).fill(0)))}},{key:"cloneState",value:function(t){return t.map(function(t){return r(t)})}},{key:"areStatesEqual",value:function(t,e){for(var n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)if(t[n][r]!==e[n][r])return!1;return!0}},{key:"transposeState",value:function(t){return t[0].map(function(e,n){return t.map(function(t){return t[n]})})}},{key:"getEmptyTiles",value:function(){for(var t=[],e=0;e<this.size;e++)for(var n=0;n<this.size;n++)0===this.state[e][n]&&t.push([e,n]);return t}}],a=[{key:"defaultState",value:function(){return Array.from({length:4},function(){return[,,,,].fill(0)})}}],e&&t(i.prototype,e),a&&t(i,a),i}()),i=Array.from(document.querySelectorAll(".field-cell")),o=document.querySelector(".button.start"),s=document.querySelector(".game-score"),u=document.querySelector(".message-win"),l=document.querySelector(".message-lose"),c=document.querySelector(".message-start"),f={ArrowLeft:function(){return a.moveLeft()},ArrowRight:function(){return a.moveRight()},ArrowUp:function(){return a.moveUp()},ArrowDown:function(){return a.moveDown()}},h=function(){var t=a.getState().flat();i.forEach(function(e,n){var r=t[n];e.className="field-cell",e.textContent=r||"",r&&e.classList.add("field-cell--".concat(r))})},v=function(){s.textContent=a.getScore()},y=function(){var t=a.getStatus();"win"===t&&u.classList.remove("hidden"),"lose"===t&&l.classList.remove("hidden")},m=function(){h(),v(),y()},d=function(){[u,l,c].forEach(function(t){t.classList.add("hidden")})};document.addEventListener("keydown",function(t){if("playing"===a.getStatus()){var e=f[t.key];e&&(e(),m())}}),o.addEventListener("click",function(){o.classList.contains("restart")&&a.restart(),a.start(),d(),m(),o.textContent="Restart",o.className="button restart"})}();
//# sourceMappingURL=index.3aa0da6d.js.map
